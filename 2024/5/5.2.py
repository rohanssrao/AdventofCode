print(sum(int(sorted(pages, key=__import__("functools").cmp_to_key(lambda a,b: 1 if [a,b] in rules else -1))[len(pages)//2]) if any(a in pages and b in pages and pages.index(a) > pages.index(b) for a,b in rules) else 0 for rules, updates in ([list(map(lambda line: __import__("re").split(r"\||,", line), filter(lambda line: line, section.split("\n")))) for section in open(0).read().split("\n\n")],) for pages in updates))
